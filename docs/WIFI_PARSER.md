# Wi-Fi Packet Parser

## Overview

`wi-fi_packet_parser_c` is a C program designed to parse Wireshark Wi-Fi capture files (`.pcap`) generated by devices
like the EtherScope nXG. It extracts key information from Wi-Fi packets, including:

- Radiotap header details: channel, signal strength (dBm), noise level (dBm), SNR, and antenna number.
- Packet data: frame type (e.g., beacon, management, control, data), receiver and transmitter MAC addresses.
- Optional features:
    - MAC vendor lookup using the IEEE OUI database.
    - Fluke product identification based on MAC addresses.
    - Warning flags for potential issues (e.g., low SNR, invalid signal levels, truncated packets).
    - SSID-specific statistics for beacon frames.

The program is lightweight, written in C, and designed to run on macOS, Linux, or other Unix-like systems. It supports
automatic downloading of the latest IEEE OUI database for MAC vendor lookups.

## Version

Current version: **1.0.7**

## License

This project is licensed under the MIT License. See the copyright notice in the source file (`parse_wifi_pacap_v107.c`)
for details.

## Requirements

- **Compiler**: A C11-compatible compiler (e.g., `clang`, `gcc`).
- **Dependencies**:
    - `libcurl`: Required for downloading the IEEE OUI database.
- **Operating System**: Tested on macOS; should work on Linux and other Unix-like systems with minor adjustments.

## Installation

### Prerequisites

1. **Install `libcurl`**:
    - On macOS (using Homebrew):
      ```bash
      brew install curl
      ```

On Debian/Ubuntu:

```bash
sudo apt-get install libcurl4-openssl-dev
```

On Fedora:

```bash
sudo dnf install libcurl-devel
```

Install a C Compiler:
On macOS, install Xcode Command Line Tools:

```bash
xcode-select --install
```

On Linux, gcc or clang is typically pre-installed or can be installed via your package manager.
Build Instructions
The project uses CMake for building. Follow these steps to build the program:

Clone the Repository (if hosted on a version control system like GitHub):

```bash
git clone <repository-url>

cd wi-fi_packet_parser_c
```

Create a Build Directory:

```bash

mkdir cmake-build-debug
cd cmake-build-debug
```

Run CMake:

```bash
cmake ..
```

Build the Program:

```bash
make
```

Alternatively, if using an IDE like CLion:

Open the project in CLion.
Reload the CMake project (File > Reload CMake Project).
Build the project (Cmd+F9 on macOS or Build > Build Project).
The executable wi_fi_packet_parser_c will be generated in the cmake-build-debug directory.

## Usage

Run the program with the following command:

```bash
./wi_fi_packet_parser_c [-m] [-p] [-w] [-sSSID] FILE.pcap
```

### Options

```bash
-m: Enable MAC vendor lookup (requires oui.txt file; automatically downloaded if missing or outdated).
-p: Enable Fluke product lookup (identifies Fluke devices based on MAC addresses).
-w: Enable warnings for potential issues (e.g., low SNR, invalid signal levels, truncated packets).
-sSSID: Report statistics for beacon frames with the specified SSID (e.g., -sMyWiFi).
```

### Example

```bash
./wi_fi_packet_parser_c -m -p -w -sMyWiFi sample.pcap
```

This command will:

* Parse sample.pcap.
* Perform MAC vendor lookups using the IEEE OUI database.
* Identify Fluke products in the packet data.
* Flag potential issues with warnings.
* Report statistics for beacon frames with the SSID MyWiFi.

## Output

The program outputs packet details to the console, including:

* Packet ID, timestamp, original and captured lengths.
* Channel, signal, noise, antenna, and SNR from the Radiotap header.
* Frame type (e.g., beacon, management, control, data).
* Receiver and transmitter MAC addresses (with vendor lookup if enabled).
* Fluke product identification (if enabled).
* SSID for beacon frames.
* Warnings (if enabled).
* Summary statistics for the specified SSID (if provided).

### Example output:

```text
id=1    time=0.000000 origLen=123  capLen=123  chan=36  sig=-45  noise=-95  ant=1  SNR=50  type=beacon  rxMac=Cisco_:aabbcc  txMac=NetSct:112233 (flukeTx:OPTIVIEW-XG)  ssid=MyWiFi
```

## Features

* Automatic OUI Database Updates: If MAC vendor lookup is enabled (-m), the program checks for the IEEE OUI database (
  oui.txt). If the file is missing or older than 24 hours, it downloads the latest version
  from https://standards-oui.ieee.org/oui/oui.txt.
* Efficient Parsing: Directly parses the IEEE oui.txt format, eliminating the need for file conversion.
* Fluke Product Detection: Identifies Fluke devices (e.g., EtherScope, AirCheck, LinkRunner) based on MAC addresses.
* Customizable Output: Options to enable/disable vendor lookup, product lookup, warnings, and SSID filtering.
* Project Structure
* parse_wifi_pacap_v107.c: Main source file containing the parser logic.
* CMakeLists.txt: CMake configuration file for building the project.
* README.md: Project documentation (this file).
* changelog.txt: Version history and changes.
* oui.txt: IEEE OUI database (downloaded automatically if needed).

## Contributing

Contributions are welcome! Please submit a pull request or open an issue on the project’s repository (if hosted on a
platform like GitHub).

## Author

Kris Armstrong
Copyright © 2019-2025 Kris Armstrong. All rights reserved.

## Known Issues

* The program assumes a specific Radiotap header format (as generated by devices like EtherScope nXG). It may need
  adjustments for other capture formats.
* Some compiler warnings (e.g., sscanf buffer overflow) have been addressed, but minor warnings may remain depending on
  the compiler and settings.
* The oui.txt file is saved in the working directory. Ensure the working directory is set correctly in your IDE or
  terminal to avoid file access issues.
* Future Improvements
* Add support for additional pcap formats or Radiotap header variations.
* Improve vendor name abbreviation logic for better readability.
* Add command-line options to customize the OUI database update frequency or file location.